<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Royal Crush — Full Gauntlet</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f1115">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrap">
  <h1>Royal Crush — Full Gauntlet</h1>
  <div class="toasts" id="toasts"></div>

  <!-- BOSS PANEL -->
  <div class="card" id="bossPanel">
    <div class="between">
      <div>
        <div class="sub">Royal</div>
        <div style="font-size:20px;font-weight:700" id="bossName">—</div>
        <div class="sub" id="bossStats">HP — • DMG —</div>
      </div>
      <div style="text-align:right">
        <div class="chip">Round <span id="roundOut">1</span></div>
        <div class="chip">POI <span id="poiVal">0</span></div>
      </div>
    </div>

    <div class="row" style="align-items:center; gap:12px; margin-top:8px">
      <div style="flex:1">
        <div class="bar"><span id="hpBar" style="width:0%"></span></div>
        <div class="between" style="margin-top:6px">
          <div style="font-size:18px;font-weight:700"><span id="hpNow">0</span>/<span id="hpMax">0</span></div>
          <div class="sub" id="prog">Run: —</div>
        </div>
      </div>
      <div class="row">
        <button class="btn mini" id="poiPlus">+POI</button>
        <button class="btn mini" id="poiMinus">−POI</button>
      </div>
    </div>

    <div class="log" id="bossLog"></div>
  </div>

  <!-- HEROES -->
  <div class="grid2" style="margin-top:12px">
    <!-- A -->
    <div class="card" id="heroA">
      <div class="between">
        <div class="row" style="gap:8px;align-items:center">
          <select id="classA">
            <option>Knight</option><option>Mage</option>
            <option>Assassin</option><option>Priest</option>
          </select>
          <span class="suits" id="suitsA"></span>
          <div class="chip">HP <span id="hpA">35</span></div>
          <span class="pill" id="assistChipA" style="display:none">Assist +0</span>
        </div>
        <div class="row" style="gap:6px">
          <button class="btn mini gray" id="hpAMinus">−1</button>
          <button class="btn mini gray" id="hpAPlus">+1</button>
        </div>
      </div>
      <div class="statline" style="margin-top:6px">
        <div>Plays: <span id="playsA">1</span></div>
        <div>Deck: <span id="deckCountA">0</span></div>
        <div>Discard: <span id="discCountA">0</span></div>
        <div>Hand: <span id="handCountA">0</span></div>
      </div>
      <div class="hand" id="handA"></div>
      <div class="row" style="margin-top:6px">
        <button class="btn" id="rollA" style="flex:1">Play Selected & Roll d12</button>
        <button class="btn gray" id="assistA">Assist Partner</button>
        <div class="chip" id="rollOutA">—</div>
        <div class="chip" id="resultA">—</div>
      </div>
    </div>

    <!-- B -->
    <div class="card" id="heroB">
      <div class="between">
        <div class="row" style="gap:8px;align-items:center">
          <select id="classB">
            <option>Knight</option><option selected>Mage</option>
            <option>Assassin</option><option>Priest</option>
          </select>
          <span class="suits" id="suitsB"></span>
          <div class="chip">HP <span id="hpB">30</span></div>
          <span class="pill" id="assistChipB" style="display:none">Assist +0</span>
        </div>
        <div class="row" style="gap:6px">
          <button class="btn mini gray" id="hpBMinus">−1</button>
          <button class="btn mini gray" id="hpBPlus">+1</button>
        </div>
      </div>
      <div class="statline" style="margin-top:6px">
        <div>Plays: <span id="playsB">1</span></div>
        <div>Deck: <span id="deckCountB">0</span></div>
        <div>Discard: <span id="discCountB">0</span></div>
        <div>Hand: <span id="handCountB">0</span></div>
      </div>
      <div class="hand" id="handB"></div>
      <div class="row" style="margin-top:6px">
        <button class="btn" id="rollB" style="flex:1">Play Selected & Roll d12</button>
        <button class="btn gray" id="assistB">Assist Partner</button>
        <div class="chip" id="rollOutB">—</div>
        <div class="chip" id="resultB">—</div>
      </div>
    </div>
  </div>

  <div class="row" style="margin-top:12px">
    <button class="btn gray" id="newRunBtn">New Run (gauntlet only)</button>
    <button class="btn gray" id="resetBoss">New Game</button>
    <label class="row" style="gap:6px;margin-left:auto">
      <input type="checkbox" id="perfModeChk" />
      <span class="sub">Performance Mode</span>
    </label>
  </div>
</div>

<!-- Rewards Modal -->
<div class="overlay" id="rewardsOverlay">
  <div class="modal">
    <div class="between" style="margin-bottom:8px">
      <h3>Royal Defeated — Rewards</h3>
      <button class="btn" id="closeRewards">Close</button>
    </div>
    <div class="sub" id="rewHint">
      Each hero auto-adds: J→6, Q→7, K→8, Joker→9 (to discard).<br/>
      <b>Legendary:</b> Hit kill → finisher auto-claims if eligible. 
      Poison kill → either hero may claim once. Jokers never grant Legendary.
    </div>
    <div class="grid2" style="margin-top:10px">
      <div class="list">
        <div class="sub" style="margin-bottom:6px">Hero A choices</div>
        <div id="choicesA"></div>
      </div>
      <div class="list">
        <div class="sub" style="margin-bottom:6px">Hero B choices</div>
        <div id="choicesB"></div>
      </div>
    </div>
    <div class="row" style="margin-top:10px">
      <button class="btn green" id="ackRewards">Next Royal</button>
      <div class="sub">Upgrades/Legendaries go to discard; appear after reshuffle.</div>
    </div>
  </div>
</div>

<!-- Assist Modal -->
<div class="overlay" id="assistOverlay">
  <div class="modal">
    <div class="between" style="margin-bottom:8px">
      <h3>Assist Partner — Sacrifice Cards</h3>
      <button class="btn" id="assistClose">Close</button>
    </div>
    <div class="sub">Select any number of cards to discard. Partner gains +1 to next d12 per card (max +3). Costs 1 play.</div>
    <div class="list" style="margin-top:10px">
      <div class="hand" id="assistPickZone"></div>
    </div>
    <div class="row" style="margin-top:10px">
      <button class="btn green" id="assistConfirm">Confirm Assist</button>
      <div class="chip" id="assistSummary">0 selected → +0 to partner</div>
    </div>
  </div>
</div>

<script type="module">
  import * as UI from './src/ui.js';
  UI.init();
</script>
</body>
</html>